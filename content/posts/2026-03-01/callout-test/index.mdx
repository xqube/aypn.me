---
title: "MDX Sample Feature Reference"
description: "A comprehensive sample showing all MDX features supported by the AyPn blog engine for LLM context."
date: "2026-02-27T10:00:00.000Z"
tags: ["sample", "mdx", "reference"]
slug: "sample-features"
coverImage: "./thumbnail.png"
---

## Frontmatter Schema

Every post uses this frontmatter structure:

```yaml
---
title: "Post Title"                    # Required — page title + SEO
description: "Short description."       # Required — meta description
date: "2026-02-27T10:00:00.000Z"       # Required — ISO 8601 date
tags: ["tag1", "tag2"]                 # Required — array of tag strings
slug: "post-slug"                      # Required — URL identifier (/blog/post-slug)
coverImage: "./thumbnail.png"          # Optional — relative path to thumbnail
---
```

### How `coverImage` works
- Path is relative to the post folder (e.g., `./thumbnail.png`)
- Resolved at compile time to `/blog/{slug}/thumbnail.png`
- If the referenced file doesn't exist on disk, `coverImage` is set to `null`
- Templates conditionally render the thumbnail — no image shown if null
- Displayed in: blog listing, homepage (New/Trending), sidebar (Latest/Trending)
- Recommended: place the image file in the same folder as `index.mdx`

---

## Folder-Based Post Structure

Posts live in date-organized folders:

```
content/posts/YYYY-MM-DD/post-name/
├── index.mdx          # Post content
├── thumbnail.png      # Cover image (optional)
├── diagram.png        # Inline images (any name)
└── screenshot.jpg     # Additional assets
```

All images inside the folder are served via `/blog/{slug}/filename.ext`.

---

## Headings + Auto Table of Contents

H2 and H3 headings are automatically extracted by `rehypeExtractToc` for the sidebar TOC. Anchor IDs are generated from heading text.

### H3 Sub-Heading Example

The TOC sidebar only appears on desktop (lg breakpoint) and renders a nested tree:
- H2 entries are top-level
- H3 entries nest under their parent H2

---

## Text Formatting (GFM)

GitHub Flavored Markdown is enabled via `remark-gfm`:

- **Bold text** and *italic text*
- ~~Strikethrough text~~
- `Inline code` with themed background
- [Autolinked URLs](https://example.com)

---

## Tables

| Feature | Status | Notes |
| :--- | :---: | :--- |
| GFM Tables | ✅ | Full support via `remark-gfm` |
| Strikethrough | ✅ | `~~text~~` syntax |
| Tasklists | ✅ | `- [x]` / `- [ ]` syntax |
| Autolinks | ✅ | URLs auto-linked |

---

## Lists and Tasklists

Unordered:
- Item 1
- Item 2
  - Nested sub-item
  - Another nested item

Ordered:
1. First step
2. Second step
3. Third step

Tasklists:
- [x] Completed task
- [ ] Incomplete task
- [x] Another completed task

---

## Code Blocks (Syntax Highlighting)

Code blocks are highlighted via `rehype-prism-plus` with custom theme colors defined in `theme.config.js`.

### JavaScript

```javascript
// Async/await with Promise.all
async function fetchDashboard(userId) {
    const [user, orders] = await Promise.all([
        fetchUser(userId),
        fetchOrders(userId),
    ]);
    return { user, orders };
}
```

### TypeScript

```typescript
interface Post {
    slug: string;
    html: string;
    toc: { id: string; text: string; depth: number }[];
    frontmatter: Record<string, unknown>;
    dirPath: string;
}
```

### Bash

```bash
# Build and deploy
npm run build
pm2 restart aypn.me
```

### JSON

```json
{
    "slug": "sample-features",
    "frontmatter": {
        "title": "MDX Sample Feature Reference",
        "tags": ["sample", "mdx"]
    }
}
```

### CSS

```css
*::-webkit-scrollbar-thumb {
    background-color: var(--color-border);
    border-radius: 9999px;
    border: 2px solid var(--color-bg);
}
```

---

## Inline Code

Use backticks for `inline code`. Examples: `npm run build`, `cache.js`, `pipeline.js`, `async/await`.

Inline code uses a distinct background (`--color-bg-inline`) and monospace font.

---

## Images (Colocated Assets)

Local images placed alongside `index.mdx` are rewritten by `rehypeRewriteImages`:

```
Markdown: ![Alt text](./diagram.png)
Renders:  <img src="/blog/sample-features/diagram.png" alt="Alt text">
```

External images also work:

```
![External](https://example.com/photo.jpg)
```

---

## Links

- [Internal link to blog listing](/blog)
- [External link (opens in new tab)](https://example.com)

External links automatically receive:
- `target="_blank"`
- `rel="noopener noreferrer"`
- CSS class `external-link`

This is handled by the `rehypeExternalLinks` plugin in `pipeline.js`.

---

## Blockquotes

> This is a standard blockquote. Use it for quotes, callouts, or important notices. Blockquotes are styled with a left accent border and muted background.

---

## Callout Blocks (GitHub-Style Alerts)

The blog engine supports GitHub-style callout blocks via the `rehypeCallouts` plugin in `pipeline.js`. Use `> [!TYPE]` syntax at the start of a blockquote.

### All 5 Callout Types

> [!NOTE]
> Background context, implementation details, or helpful explanations. This is a **NOTE** callout — used for supplementary information the reader might find useful.

> [!TIP]
> Performance optimizations, best practices, or efficiency suggestions. This is a **TIP** callout — use it for pro tips and recommendations.

> [!IMPORTANT]
> Essential requirements, critical steps, or must-know information. This is an **IMPORTANT** callout — draw attention to key facts.

> [!WARNING]
> Breaking changes, compatibility issues, or potential problems. This is a **WARNING** callout — flag things that could go wrong.

> [!CAUTION]
> High-risk actions that could cause data loss or security vulnerabilities. This is a **CAUTION** callout — the most severe alert level.

### Usage Syntax

```markdown
> [!NOTE]
> Your note content here. Supports **bold**, `code`, and other inline formatting.

> [!WARNING]
> Multi-line content works too.
> Just continue with the `>` prefix.
```

### How It Works
1. The `rehypeCallouts` plugin in `pipeline.js` detects `[!TYPE]` at the start of a blockquote
2. It removes the raw `[!TYPE]` text
3. Adds a CSS class (`callout-note`, `callout-warning`, etc.) to the blockquote
4. Injects a styled title element with the type label
5. CSS in `input.css` applies unique border color, background tint, and title color per type

---

## Raw HTML Support

Because `rehype-raw` is enabled, you can embed arbitrary HTML directly in MDX:

<div style="padding: 1rem; border: 1px solid #ccc; border-radius: 8px; margin: 1rem 0;">
  <strong>This is raw HTML rendering.</strong> Useful for embedding Twitter widgets, Telegram posts, or custom interactive elements with <code>&lt;script&gt;</code> tags.
</div>

---

## Embedded Widgets

Twitter and Telegram embeds work via raw HTML + script tags:

```html
<!-- Twitter embed example -->
<blockquote class="twitter-tweet">
  <a href="https://twitter.com/example/status/123"></a>
</blockquote>
<script async src="https://platform.twitter.com/widgets.js"></script>
```

---

## Build System Features

### Pre-Build Compilation
- Posts are compiled to `dist/posts/{slug}.json` via `scripts/build-content.js`
- SHA-256 hashing enables incremental builds (unchanged posts are skipped)
- Build command: `npm run build:content`

### Runtime Loading
- `cache.js` loads per-post JSON files from `dist/posts/` at startup (~30ms)
- Falls back to runtime compilation if no artifacts exist

### Dev Mode Hot Reload
- `chokidar` watches `content/posts/**/*.mdx` for changes
- Only the changed file is recompiled — no full restart needed
- Start with: `npm run dev`

### Derived Indexes (Computed Once at Startup)
- **sortedPosts** — All posts sorted by date descending
- **trendingPosts** — Sorted by tag count descending
- **tagCounts** — Aggregated `{ tag: count }` object

---

## Template Rendering Features

### Blog Listing (`/blog`)
- Paginated display (configurable posts per page)
- Thumbnail shown if `coverImage` exists, hidden if not
- Tags displayed per post
- Date formatting

### Homepage (`/`)
- **New Posts** section — latest 5 posts
- **Trending Posts** section — posts sorted by tag count
- Tags cloud

### Sidebar (Right Column)
- **Latest** — 3 most recent posts with thumbnails (48px)
- **Trending** — 3 trending posts with thumbnails (48px)

### Single Post (`/blog/:slug`)
- Left sidebar: auto-generated Table of Contents (desktop only)
- Right sidebar: Latest + Trending posts
- Full compiled HTML body
- Static asset serving for colocated images (`/blog/:slug/*`)

---

## Theme System

Colors are defined in `theme.config.js` with separate light and dark palettes. CSS Custom Properties are set in `input.css` under `:root` (light) and `.dark` (dark mode), then mapped to Tailwind utilities via `tailwind.config.js`.

**Token flow:** `theme.config.js` → `input.css` (CSS vars) → `tailwind.config.js` (semantic classes)

**Semantic tokens available:**
- `bg-surface`, `bg-surface-alt` — background surfaces
- `text-content`, `text-heading`, `text-muted`, `text-faint` — text hierarchy
- `text-accent`, `text-accent-hover` — accent colors
- `border-line`, `border-line-subtle` — borders

Syntax highlighting colors are also theme-aware and switch automatically with dark mode.

---

## Search

A client-side search index is generated at build time:
- Written to `public/search-index.json`
- Contains title, description, tags, and slug for each post
- Rebuilt on every `npm run build:content`

---

## Security

- `helmet` middleware with Content Security Policy
- External links: `target="_blank"`, `rel="noopener noreferrer"`
- Blog asset route: path traversal protection (resolved paths checked)
- `gzip` compression via `compression` middleware
